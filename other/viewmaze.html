<!doctype html>

<html>
 <head>
  <link rel="icon" href="data:;base64,iVBORw0KGgo="><!-- prevent favicon.ico requests -->
  <title>Maze Array Viewer</title>

  <style>
  table.maze td, table.key th { width: 30px; height: 30px; text-align: center; }
  td, th.sq { background-color: #ddd; font-style: italic; }
  td.wall,th.wall { background-color: #777; color: #ccc; font-size: 0.8em; }
  th { border: 0; font-weight: normal; }
  input, button { height: 2em; }
  input { width: 60px; }
  div { margin-bottom: 10px; }
  span.title { border: 2px inset grey; margin-left: 20px; padding: 6px; background-color: #EEE; }
  table.key { border: 1px solid black; }
  table.key td { background-color: #F0F0F0; }
  table.key td.h { background-color: #606060; color: white; text-align: center; }
  </style>
 </head>

 <body>
  <div>
    Level: <input type="number" id="level">
    <span id="controls"></span><span class="title">Visualize the MazeObject.data[x:&hArr;][z:&vArr;] array</span>
  </div>
  <div id="output"></div>

  <script type="module">

	import { generateMazeData } from '../src/mazegen';

	const defaultLevel = 7;

	const controls = document.getElementById('controls');
	const levelInput = document.getElementById('level');

	let button =  document.createElement("button");
	button.innerHTML = 'Generate Random Maze';
	button.onclick = showMaze;
	controls.appendChild(button);

	levelInput.value = defaultLevel;
	showMaze();


	function showMaze() {

		let level = parseInt(levelInput.value, 10);
		if (!level || level < 1) {
			levelInput.value = defaultLevel;
			level = defaultLevel;
		}

		const maze = generateMazeData(level);

		let html = '<table class="maze"><tr><th></th>';

		for (let x = 0; x < maze.size.x; x++) {
			html += '<th>' + x + '</th>';
		}

		html += '</tr>';

		for (let z =  0; z < maze.size.z; z++) {
     		html += '<tr>' + '<th>' + z + '</th>';
			for (let x = 0; x < maze.size.x; x++) {
				const val = maze.data[x][z];
				if (val === false) {
					html += '<td class="wall">false</td>';
				} else if (val === '.') {
					html += '<td>&nbsp;</td>';
				} else {
     				html += '<td>' + val + '</td>';
     			}
			}
			html += '</tr>';
		}

		html += '</table>';

		document.getElementById('output').innerHTML = html;
	}
  </script>
  <table class="key">
	<tr><td colspan=2 class="h">Key</th></tr>
	<tr><th class="sq">S</th><td>Player Start Position</td></tr>
	<tr><th class="sq">E</th><td>Path End</td></tr>
	<tr><th class="sq">H</th><td>Hole in wall (exit)</td></tr>
	<tr><th class="wall">false</th><td>Wall</td></tr>
	<tr><th class="sq">*</th><td>Path from S to E</td></tr>
	<tr><th class="sq">D</th><td>Dead end</td></tr>
  </table>
 </body>
</html>
